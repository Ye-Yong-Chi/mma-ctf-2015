#!/usr/bin/env ruby

require './ctfutils'

r = 3
e = 65537

n = 167891001700388890587843249700549749388526432049480469518286617353920544258774519927209158925778143308323065254691520342763823691453238628056767074647261280532853686188135635704146982794597383205258532849509382400026732518927013916395873932058316105952437693180982367272310066869071042063581536335953290566509

pipe = popen('nc cry1.chal.mmactf.link 44816')
pipe.get
pipe.get
pipe.get
m = pipe.get.to_i

STDERR.puts "m=#{m}"

md = (r ** e * m) % n

pipe2 = popen('nc cry1.chal.mmactf.link 44815')
pipe2.puts md
sd = pipe2.get.to_i

s = (sd * invmod(r, n)) % n

pipe.puts s

pipe.interactive
